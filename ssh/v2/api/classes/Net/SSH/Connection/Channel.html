<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Net::SSH::Connection::Channel</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Net::SSH::Connection::Channel</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../../files/lib/net/ssh/connection/channel_rb.html">
                lib/net/ssh/connection/channel.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
The channel abstraction. Multiple &quot;channels&quot; can be multiplexed
onto a single <a href="../../SSH.html">SSH</a> channel, each operating
independently and seemingly in parallel. This class represents a single
such channel. Most operations performed with the <a
href="../../SSH.html">Net::SSH</a> library will involve using one or more
channels.
</p>
<p>
Channels are intended to be used asynchronously. You request that one be
opened (via <a
href="Session.html#M000249">Connection::Session#open_channel</a>), and when
it is opened, your callback is invoked. Then, you set various other
callbacks on the newly opened channel, which are called in response to the
corresponding events. Programming with <a
href="../../SSH.html">Net::SSH</a> works best if you think of your programs
as state machines. Complex programs are best implemented as objects that
wrap a channel. See Net::SCP and Net::SFTP for examples of how complex
state machines can be built on top of the <a href="../../SSH.html">SSH</a>
protocol.
</p>
<pre>
  ssh.open_channel do |channel|
    channel.exec(&quot;/invoke/some/command&quot;) do |ch, success|
      abort &quot;could not execute command&quot; unless success

      channel.on_data do |ch, data|
        puts &quot;got stdout: #{data}&quot;
        channel.send_data &quot;something for stdin\n&quot;
      end

      channel.on_extended_data do |ch, type, data|
        puts &quot;got stderr: #{data}&quot;
      end

      channel.on_close do |ch|
        puts &quot;channel is closing!&quot;
      end
    end
  end

  ssh.loop
</pre>
<p>
Channels also have a basic hash-like interface, that allows programs to
store arbitrary state information on a channel object. This helps simplify
the writing of state machines, especially when you may be juggling multiple
open channels at the same time.
</p>
<p>
Note that data sent across <a href="../../SSH.html">SSH</a> channels are
governed by maximum packet sizes and maximum window sizes. These details
are managed internally by <a
href="Channel.html">Net::SSH::Connection::Channel</a>, so you may remain
blissfully ignorant if you so desire, but you can always inspect the
current maximums, as well as the remaining window size, using the reader
attributes for those values.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000208">[]</a>&nbsp;&nbsp;
      <a href="#M000209">[]=</a>&nbsp;&nbsp;
      <a href="#M000215">active?</a>&nbsp;&nbsp;
      <a href="#M000218">close</a>&nbsp;&nbsp;
      <a href="#M000217">closing?</a>&nbsp;&nbsp;
      <a href="#M000233">do_close</a>&nbsp;&nbsp;
      <a href="#M000232">do_eof</a>&nbsp;&nbsp;
      <a href="#M000231">do_extended_data</a>&nbsp;&nbsp;
      <a href="#M000234">do_failure</a>&nbsp;&nbsp;
      <a href="#M000230">do_open_failed</a>&nbsp;&nbsp;
      <a href="#M000235">do_success</a>&nbsp;&nbsp;
      <a href="#M000212">env</a>&nbsp;&nbsp;
      <a href="#M000220">eof!</a>&nbsp;&nbsp;
      <a href="#M000219">eof?</a>&nbsp;&nbsp;
      <a href="#M000210">exec</a>&nbsp;&nbsp;
      <a href="#M000207">new</a>&nbsp;&nbsp;
      <a href="#M000225">on_close</a>&nbsp;&nbsp;
      <a href="#M000222">on_data</a>&nbsp;&nbsp;
      <a href="#M000226">on_eof</a>&nbsp;&nbsp;
      <a href="#M000223">on_extended_data</a>&nbsp;&nbsp;
      <a href="#M000227">on_open_failed</a>&nbsp;&nbsp;
      <a href="#M000224">on_process</a>&nbsp;&nbsp;
      <a href="#M000228">on_request</a>&nbsp;&nbsp;
      <a href="#M000221">process</a>&nbsp;&nbsp;
      <a href="#M000213">request_pty</a>&nbsp;&nbsp;
      <a href="#M000229">send_channel_request</a>&nbsp;&nbsp;
      <a href="#M000214">send_data</a>&nbsp;&nbsp;
      <a href="#M000211">subsystem</a>&nbsp;&nbsp;
      <a href="#M000216">wait</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name"><a href="Constants.html">Constants</a></span>
        <span class="include-name"><a href="../Loggable.html">Loggable</a></span>
      </div>
    </div>

    <div id="section">


    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">VALID_PTY_OPTIONS</td>
          <td>=</td>
          <td class="context-item-value">{ :term        =&gt; &quot;xterm&quot;,                           :chars_wide  =&gt; 80,                           :chars_high  =&gt; 24,                           :pixels_wide =&gt; 640,                           :pixels_high =&gt; 480,                           :modes       =&gt; {} }</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
A hash of the valid PTY options (see <a
href="Channel.html#M000213">request_pty</a>).

</td>
        </tr>
        </table>
      </div>
    </div>



    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">connection</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The underlying <a href="Session.html">Net::SSH::Connection::Session</a>
instance that supports this channel.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">local_id</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The local id for this channel, assigned by the <a
href="Session.html">Net::SSH::Connection::Session</a> instance.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">local_maximum_packet_size</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The maximum packet size that the local host can receive.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">local_maximum_window_size</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The maximum amount of data that the local end of this channel can receive.
This is a total, not per-packet.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">local_window_size</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
This is the remaining window size on the local end of this channel. When
this reaches zero, no more data can be received.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">properties</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
A hash of properties for this channel. These can be used to store state
information about this channel. See also #[] and #[]=.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">remote_id</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The remote id for this channel, assigned by the remote host.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">remote_maximum_packet_size</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The maximum packet size that the remote host can receive.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">remote_maximum_window_size</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The maximum amount of data that the remote end of this channel can receive.
This is a total, not per-packet.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">remote_window_size</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
This is the remaining window size on the remote end of this channel. When
this reaches zero, no more data can be sent.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">type</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The type of this channel, usually &quot;session&quot;.

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000207" class="method-detail">
        <a name="M000207"></a>

        <div class="method-heading">
          <a href="#M000207" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(connection, type, local_id, &amp;on_confirm_open)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Instantiates a <a href="Channel.html#M000207">new</a> channel on the given
connection, of the given type, and with the given id. If a block is given,
it will be remembered until the channel is confirmed open by the server,
and will be invoked at that time (see do_open_confirmation).
</p>
<p>
This also sets the default maximum packet size and maximum window size.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000207-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000207-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 110</span>
110:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">connection</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">local_id</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">on_confirm_open</span>)
111:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">logger</span> = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">logger</span>
112: 
113:       <span class="ruby-ivar">@connection</span> = <span class="ruby-identifier">connection</span>
114:       <span class="ruby-ivar">@type</span>       = <span class="ruby-identifier">type</span>
115:       <span class="ruby-ivar">@local_id</span>   = <span class="ruby-identifier">local_id</span>
116: 
117:       <span class="ruby-ivar">@local_maximum_packet_size</span> = <span class="ruby-value">0x10000</span>
118:       <span class="ruby-ivar">@local_window_size</span> = <span class="ruby-ivar">@local_maximum_window_size</span> = <span class="ruby-value">0x20000</span>
119: 
120:       <span class="ruby-ivar">@on_confirm_open</span> = <span class="ruby-identifier">on_confirm_open</span>
121: 
122:       <span class="ruby-ivar">@output</span> = <span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">new</span>
123: 
124:       <span class="ruby-ivar">@properties</span> = {}
125: 
126:       <span class="ruby-ivar">@pending_requests</span> = []
127:       <span class="ruby-ivar">@on_open_failed</span> = <span class="ruby-ivar">@on_data</span> = <span class="ruby-ivar">@on_extended_data</span> = <span class="ruby-ivar">@on_process</span> = <span class="ruby-ivar">@on_close</span> = <span class="ruby-ivar">@on_eof</span> = <span class="ruby-keyword kw">nil</span>
128:       <span class="ruby-ivar">@on_request</span> = {}
129:       <span class="ruby-ivar">@closing</span> = <span class="ruby-ivar">@eof</span> = <span class="ruby-keyword kw">false</span>
130:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000208" class="method-detail">
        <a name="M000208"></a>

        <div class="method-heading">
          <a href="#M000208" class="method-signature">
          <span class="method-name">[]</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
A shortcut for accessing properties of the channel (see properties).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000208-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000208-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 133</span>
133:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">name</span>)
134:       <span class="ruby-ivar">@properties</span>[<span class="ruby-identifier">name</span>]
135:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000209" class="method-detail">
        <a name="M000209"></a>

        <div class="method-heading">
          <a href="#M000209" class="method-signature">
          <span class="method-name">[]=</span><span class="method-args">(name, value)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
A shortcut for setting properties of the channel (see properties).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000209-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000209-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 138</span>
138:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span>)
139:       <span class="ruby-ivar">@properties</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">value</span>
140:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000215" class="method-detail">
        <a name="M000215"></a>

        <div class="method-heading">
          <a href="#M000215" class="method-signature">
          <span class="method-name">active?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if the channel exists in the channel list of the session, and
false otherwise. This can be used to determine whether a channel has been
closed or not.
</p>
<pre>
  ssh.loop { channel.active? }
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000215-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000215-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 259</span>
259:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">active?</span>
260:       <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">channels</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-identifier">local_id</span>)
261:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000218" class="method-detail">
        <a name="M000218"></a>

        <div class="method-heading">
          <a href="#M000218" class="method-signature">
          <span class="method-name">close</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Requests that the channel be closed. If the channel is already closing,
this does nothing, nor does it do anything if the channel has not yet been
confirmed open (see do_open_confirmation). Otherwise, it sends a
CHANNEL_CLOSE message and marks the channel as closing.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000218-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000218-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 284</span>
284:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">close</span>
285:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@closing</span>
286:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">remote_id</span>
287:         <span class="ruby-ivar">@closing</span> = <span class="ruby-keyword kw">true</span>
288:         <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">send_message</span>(<span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">from</span>(<span class="ruby-identifier">:byte</span>, <span class="ruby-constant">CHANNEL_CLOSE</span>, <span class="ruby-identifier">:long</span>, <span class="ruby-identifier">remote_id</span>))
289:       <span class="ruby-keyword kw">end</span>
290:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000217" class="method-detail">
        <a name="M000217"></a>

        <div class="method-heading">
          <a href="#M000217" class="method-signature">
          <span class="method-name">closing?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if the channel is currently closing, but not actually closed.
A channel is closing when, for instance, <a
href="Channel.html#M000218">close</a> has been invoked, but the server has
not yet responded with a CHANNEL_CLOSE packet of its own.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000217-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000217-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 276</span>
276:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">closing?</span>
277:       <span class="ruby-ivar">@closing</span>
278:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000233" class="method-detail">
        <a name="M000233"></a>

        <div class="method-heading">
          <a href="#M000233" class="method-signature">
          <span class="method-name">do_close</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Invokes the <a href="Channel.html#M000225">on_close</a> callback when the
server closes a channel. The channel is the only argument.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000233-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000233-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 584</span>
584:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_close</span>
585:         <span class="ruby-ivar">@on_close</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword kw">self</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@on_close</span>
586:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000232" class="method-detail">
        <a name="M000232"></a>

        <div class="method-heading">
          <a href="#M000232" class="method-signature">
          <span class="method-name">do_eof</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Invokes the <a href="Channel.html#M000226">on_eof</a> callback when the
server indicates that no further data is forthcoming. The callback is
invoked with the channel as the argument.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000232-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000232-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 578</span>
578:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_eof</span>
579:         <span class="ruby-ivar">@on_eof</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword kw">self</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@on_eof</span>
580:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000231" class="method-detail">
        <a name="M000231"></a>

        <div class="method-heading">
          <a href="#M000231" class="method-signature">
          <span class="method-name">do_extended_data</span><span class="method-args">(type, data)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Invokes the <a href="Channel.html#M000223">on_extended_data</a> callback
when the server sends extended data to the channel. This will reduce the
available window size on the local end. The callback is invoked with the
channel, type, and data.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000231-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000231-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 570</span>
570:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_extended_data</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">data</span>)
571:         <span class="ruby-identifier">update_local_window_size</span>(<span class="ruby-identifier">data</span>.<span class="ruby-identifier">length</span>)
572:         <span class="ruby-ivar">@on_extended_data</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">data</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@on_extended_data</span>
573:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000234" class="method-detail">
        <a name="M000234"></a>

        <div class="method-heading">
          <a href="#M000234" class="method-signature">
          <span class="method-name">do_failure</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Invokes the next pending request callback with <tt>false</tt> as the second
argument.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000234-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000234-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 590</span>
590:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_failure</span>
591:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">callback</span> = <span class="ruby-identifier">pending_requests</span>.<span class="ruby-identifier">shift</span>
592:           <span class="ruby-identifier">callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-keyword kw">false</span>)
593:         <span class="ruby-keyword kw">else</span>
594:           <span class="ruby-identifier">error</span> { <span class="ruby-value str">&quot;channel failure recieved with no pending request to handle it (bug?)&quot;</span> }
595:         <span class="ruby-keyword kw">end</span>
596:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000230" class="method-detail">
        <a name="M000230"></a>

        <div class="method-heading">
          <a href="#M000230" class="method-signature">
          <span class="method-name">do_open_failed</span><span class="method-args">(reason_code, description)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Invoked when the server failed to open the channel. If an <a
href="Channel.html#M000227">on_open_failed</a> callback was specified, it
will be invoked with the channel, reason code, and description as
arguments. Otherwise, a <a
href="../ChannelOpenFailed.html">ChannelOpenFailed</a> exception will be
raised.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000230-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000230-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 515</span>
515:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_open_failed</span>(<span class="ruby-identifier">reason_code</span>, <span class="ruby-identifier">description</span>)
516:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@on_open_failed</span>
517:           <span class="ruby-ivar">@on_open_failed</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">reason_code</span>, <span class="ruby-identifier">description</span>)
518:         <span class="ruby-keyword kw">else</span>
519:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">ChannelOpenFailed</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">reason_code</span>, <span class="ruby-identifier">description</span>)
520:         <span class="ruby-keyword kw">end</span>          
521:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000235" class="method-detail">
        <a name="M000235"></a>

        <div class="method-heading">
          <a href="#M000235" class="method-signature">
          <span class="method-name">do_success</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Invokes the next pending request callback with <tt>true</tt> as the second
argument.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000235-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000235-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 600</span>
600:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_success</span>
601:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">callback</span> = <span class="ruby-identifier">pending_requests</span>.<span class="ruby-identifier">shift</span>
602:           <span class="ruby-identifier">callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-keyword kw">true</span>)
603:         <span class="ruby-keyword kw">else</span>
604:           <span class="ruby-identifier">error</span> { <span class="ruby-value str">&quot;channel success recieved with no pending request to handle it (bug?)&quot;</span> }
605:         <span class="ruby-keyword kw">end</span>
606:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000212" class="method-detail">
        <a name="M000212"></a>

        <div class="method-heading">
          <a href="#M000212" class="method-signature">
          <span class="method-name">env</span><span class="method-args">(variable_name, variable_value, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Syntactic sugar for setting an environment variable in the remote <a
href="Channel.html#M000221">process</a>&#8217; environment. Note that for
security reasons, the server may refuse to set certain environment
variables, or all, at the server&#8216;s discretion. If you are connecting
to an OpenSSH server, you will need to update the AcceptEnv setting in the
sshd_config to include the environment variables you want to send.
</p>
<pre>
  channel.env &quot;PATH&quot;, &quot;/usr/local/bin&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000212-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000212-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 187</span>
187:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">env</span>(<span class="ruby-identifier">variable_name</span>, <span class="ruby-identifier">variable_value</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
188:       <span class="ruby-identifier">send_channel_request</span>(<span class="ruby-value str">&quot;env&quot;</span>, <span class="ruby-identifier">:string</span>, <span class="ruby-identifier">variable_name</span>, <span class="ruby-identifier">:string</span>, <span class="ruby-identifier">variable_value</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
189:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000220" class="method-detail">
        <a name="M000220"></a>

        <div class="method-heading">
          <a href="#M000220" class="method-signature">
          <span class="method-name">eof!</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Tells the remote end of the channel that no more data is forthcoming from
this end of the channel. The remote end may still send data.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000220-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000220-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 301</span>
301:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">eof!</span>
302:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">eof?</span>
303:       <span class="ruby-ivar">@eof</span> = <span class="ruby-keyword kw">true</span>
304:       <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">send_message</span>(<span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">from</span>(<span class="ruby-identifier">:byte</span>, <span class="ruby-constant">CHANNEL_EOF</span>, <span class="ruby-identifier">:long</span>, <span class="ruby-identifier">remote_id</span>))
305:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000219" class="method-detail">
        <a name="M000219"></a>

        <div class="method-heading">
          <a href="#M000219" class="method-signature">
          <span class="method-name">eof?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if the local end of the channel has declared that no more data
is forthcoming (see eof!). Trying to send data via <a
href="Channel.html#M000214">send_data</a> when this is true will result in
an exception being raised.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000219-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000219-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 295</span>
295:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">eof?</span>
296:       <span class="ruby-ivar">@eof</span>
297:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000210" class="method-detail">
        <a name="M000210"></a>

        <div class="method-heading">
          <a href="#M000210" class="method-signature">
          <span class="method-name">exec</span><span class="method-args">(command, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Syntactic sugar for executing a command. Sends a channel request asking
that the given command be invoked. If the block is given, it will be called
when the server responds. The first parameter will be the channel, and the
second will be true or false, indicating whether the request succeeded or
not. In this case, success means that the command is being executed, not
that it has completed, and failure means that the command altogether failed
to be executed.
</p>
<pre>
  channel.exec &quot;ls -l /home&quot; do |ch, success|
    if success
      puts &quot;command has begun executing...&quot;
      # this is a good place to hang callbacks like #on_data...
    else
      puts &quot;alas! the command could not be invoked!&quot;
    end
  end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000210-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000210-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 158</span>
158:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">exec</span>(<span class="ruby-identifier">command</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
159:       <span class="ruby-identifier">send_channel_request</span>(<span class="ruby-value str">&quot;exec&quot;</span>, <span class="ruby-identifier">:string</span>, <span class="ruby-identifier">command</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
160:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000225" class="method-detail">
        <a name="M000225"></a>

        <div class="method-heading">
          <a href="#M000225" class="method-signature">
          <span class="method-name">on_close</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Registers a callback to be invoked when the server acknowledges that a
channel is closed. This is invoked with the channel as the sole argument.
</p>
<pre>
  channel.on_close do |ch|
    puts &quot;remote end is closing!&quot;
  end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000225-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000225-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 378</span>
378:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_close</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
379:       <span class="ruby-identifier">old</span>, <span class="ruby-ivar">@on_close</span> = <span class="ruby-ivar">@on_close</span>, <span class="ruby-identifier">block</span>
380:       <span class="ruby-identifier">old</span>
381:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000222" class="method-detail">
        <a name="M000222"></a>

        <div class="method-heading">
          <a href="#M000222" class="method-signature">
          <span class="method-name">on_data</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Registers a callback to be invoked when data packets are received by the
channel. The callback is called with the channel as the first argument, and
the data as the second.
</p>
<pre>
  channel.on_data do |ch, data|
    puts &quot;got data: #{data.inspect}&quot;
  end
</pre>
<p>
Data received this way is typically the data written by the remote <a
href="Channel.html#M000221">process</a> to its <tt>stdout</tt> stream.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000222-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000222-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 325</span>
325:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_data</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
326:       <span class="ruby-identifier">old</span>, <span class="ruby-ivar">@on_data</span> = <span class="ruby-ivar">@on_data</span>, <span class="ruby-identifier">block</span>
327:       <span class="ruby-identifier">old</span>
328:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000226" class="method-detail">
        <a name="M000226"></a>

        <div class="method-heading">
          <a href="#M000226" class="method-signature">
          <span class="method-name">on_eof</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Registers a callback to be invoked when the server indicates that no more
data will be sent to the channel (although the channel can still send data
to the server). The channel is the sole argument to the callback.
</p>
<pre>
  channel.on_eof do |ch|
    puts &quot;remote end is done sending data&quot;
  end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000226-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000226-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 390</span>
390:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_eof</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
391:       <span class="ruby-identifier">old</span>, <span class="ruby-ivar">@on_eof</span> = <span class="ruby-ivar">@on_eof</span>, <span class="ruby-identifier">block</span>
392:       <span class="ruby-identifier">old</span>
393:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000223" class="method-detail">
        <a name="M000223"></a>

        <div class="method-heading">
          <a href="#M000223" class="method-signature">
          <span class="method-name">on_extended_data</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Registers a callback to be invoked when extended data packets are received
by the channel. The callback is called with the channel as the first
argument, the data type (as an integer) as the second, and the data as the
third. Extended data is almost exclusively used to send <tt>stderr</tt>
data (<tt>type</tt> == 1). Other extended data types are not defined by the
<a href="../../SSH.html">SSH</a> protocol.
</p>
<pre>
  channel.on_extended_data do |ch, type, data|
    puts &quot;got stderr: #{data.inspect}&quot;
  end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000223-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000223-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 340</span>
340:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_extended_data</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
341:       <span class="ruby-identifier">old</span>, <span class="ruby-ivar">@on_extended_data</span> = <span class="ruby-ivar">@on_extended_data</span>, <span class="ruby-identifier">block</span>
342:       <span class="ruby-identifier">old</span>
343:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000227" class="method-detail">
        <a name="M000227"></a>

        <div class="method-heading">
          <a href="#M000227" class="method-signature">
          <span class="method-name">on_open_failed</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Registers a callback to be invoked when the server was unable to open the
requested channel. The channel itself will be passed to the block, along
with the integer &quot;reason code&quot; for the failure, and a textual
description of the failure from the server.
</p>
<pre>
  channel = session.open_channel do |ch|
    # ..
  end

  channel.on_open_failed { |ch, code, desc| ... }
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000227-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000227-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 405</span>
405:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_open_failed</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
406:       <span class="ruby-identifier">old</span>, <span class="ruby-ivar">@on_open_failed</span> = <span class="ruby-ivar">@on_open_failed</span>, <span class="ruby-identifier">block</span>
407:       <span class="ruby-identifier">old</span>
408:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000224" class="method-detail">
        <a name="M000224"></a>

        <div class="method-heading">
          <a href="#M000224" class="method-signature">
          <span class="method-name">on_process</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Registers a callback to be invoked for each pass of the event loop for this
channel. There are no guarantees on timeliness in the event loop, but it
will be called roughly once for each packet received by the connection (not
the channel). This callback is invoked with the channel as the sole
argument.
</p>
<p>
Here&#8216;s an example that accumulates the channel data into a variable
on the channel itself, and displays individual lines in the input one at a
time when the channel is processed:
</p>
<pre>
  channel[:data] = &quot;&quot;

  channel.on_data do |ch, data|
    channel[:data] &lt;&lt; data
  end

  channel.on_process do |ch|
    if channel[:data] =~ /^.*?\n/
      puts $&amp;
      channel[:data] = $'
    end
  end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000224-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000224-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 367</span>
367:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_process</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
368:       <span class="ruby-identifier">old</span>, <span class="ruby-ivar">@on_process</span> = <span class="ruby-ivar">@on_process</span>, <span class="ruby-identifier">block</span>
369:       <span class="ruby-identifier">old</span>
370:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000228" class="method-detail">
        <a name="M000228"></a>

        <div class="method-heading">
          <a href="#M000228" class="method-signature">
          <span class="method-name">on_request</span><span class="method-args">(type, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Registers a callback to be invoked when a channel request of the given type
is received. The callback will receive the channel as the first argument,
and the associated (unparsed) data as the second. The data will be a <a
href="../Buffer.html">Net::SSH::Buffer</a> that you will need to parse,
yourself, according to the kind of request you are watching.
</p>
<p>
By default, if the request wants a reply, <a
href="../../SSH.html">Net::SSH</a> will send a CHANNEL_SUCCESS response for
any request that was handled by a registered callback, and CHANNEL_FAILURE
for any that wasn&#8216;t, but if you want your registered callback to
result in a CHANNEL_FAILURE response, just raise <a
href="../ChannelRequestFailed.html">Net::SSH::ChannelRequestFailed</a>.
</p>
<p>
Some common channel requests that your programs might want to listen for
are:
</p>
<ul>
<li>&quot;exit-status&quot; : the exit status of the remote <a
href="Channel.html#M000221">process</a> will be reported as a long integer
in the data buffer, which you can grab via data.read_long.

</li>
<li>&quot;exit-signal&quot; : if the remote <a
href="Channel.html#M000221">process</a> died as a result of a signal being
sent to it, the signal will be reported as a string in the data, via
data.read_string. (Not all <a href="../../SSH.html">SSH</a> servers support
this channel request type.)

<p>
channel.on_request &quot;exit-status&quot; do |ch, data|
</p>
<pre>
  puts &quot;process terminated with exit status: #{data.read_long}&quot;
</pre>
<p>
end
</p>
</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000228-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000228-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 436</span>
436:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_request</span>(<span class="ruby-identifier">type</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
437:       <span class="ruby-identifier">old</span>, <span class="ruby-ivar">@on_request</span>[<span class="ruby-identifier">type</span>] = <span class="ruby-ivar">@on_request</span>[<span class="ruby-identifier">type</span>], <span class="ruby-identifier">block</span>
438:       <span class="ruby-identifier">old</span>
439:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000221" class="method-detail">
        <a name="M000221"></a>

        <div class="method-heading">
          <a href="#M000221" class="method-signature">
          <span class="method-name">process</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
If an <a href="Channel.html#M000224">on_process</a> handler has been set
up, this will cause it to be invoked (passing the channel itself as an
argument). It also causes all pending output to be enqueued as CHANNEL_DATA
packets (see enqueue_pending_output).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000221-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000221-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 310</span>
310:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">process</span>
311:       <span class="ruby-ivar">@on_process</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword kw">self</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@on_process</span>
312:       <span class="ruby-identifier">enqueue_pending_output</span>
313:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000213" class="method-detail">
        <a name="M000213"></a>

        <div class="method-heading">
          <a href="#M000213" class="method-signature">
          <span class="method-name">request_pty</span><span class="method-args">(opts={}, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Requests that a pseudo-tty (or &quot;pty&quot;) be made available for this
channel. This is useful when you want to invoke and interact with some kind
of screen-based program (e.g., vim, or some menuing system).
</p>
<p>
Note, that without a pty some programs (e.g. sudo, or subversion) on some
systems, will not be able to run interactively, and will error instead of
prompt if they ever need some user interaction.
</p>
<p>
Note, too, that when a pty is requested, user&#8216;s shell configuration
scripts (.bashrc and such) are not run by default, whereas they are run
when a pty is not present.
</p>
<pre>
  channel.request_pty do |ch, success|
    if success
      puts &quot;pty successfully obtained&quot;
    else
      puts &quot;could not obtain pty&quot;
    end
  end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000213-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000213-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 218</span>
218:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">request_pty</span>(<span class="ruby-identifier">opts</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
219:       <span class="ruby-identifier">extra</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">keys</span> <span class="ruby-operator">-</span> <span class="ruby-constant">VALID_PTY_OPTIONS</span>.<span class="ruby-identifier">keys</span>
220:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;invalid option(s) to request_pty: #{extra.inspect}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">extra</span>.<span class="ruby-identifier">any?</span>
221: 
222:       <span class="ruby-identifier">opts</span> = <span class="ruby-constant">VALID_PTY_OPTIONS</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>)
223: 
224:       <span class="ruby-identifier">modes</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:modes</span>].<span class="ruby-identifier">inject</span>(<span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">new</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">memo</span>, (<span class="ruby-identifier">mode</span>, <span class="ruby-identifier">data</span>)<span class="ruby-operator">|</span>
225:         <span class="ruby-identifier">memo</span>.<span class="ruby-identifier">write_byte</span>(<span class="ruby-identifier">mode</span>).<span class="ruby-identifier">write_long</span>(<span class="ruby-identifier">data</span>)
226:       <span class="ruby-keyword kw">end</span>
227:       <span class="ruby-comment cmt"># mark the end of the mode opcode list with a 0 byte</span>
228:       <span class="ruby-identifier">modes</span>.<span class="ruby-identifier">write_byte</span>(<span class="ruby-value">0</span>)
229: 
230:       <span class="ruby-identifier">send_channel_request</span>(<span class="ruby-value str">&quot;pty-req&quot;</span>, <span class="ruby-identifier">:string</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:term</span>],
231:         <span class="ruby-identifier">:long</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:chars_wide</span>], <span class="ruby-identifier">:long</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:chars_high</span>],
232:         <span class="ruby-identifier">:long</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:pixels_wide</span>], <span class="ruby-identifier">:long</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:pixels_high</span>],
233:         <span class="ruby-identifier">:string</span>, <span class="ruby-identifier">modes</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
234:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000229" class="method-detail">
        <a name="M000229"></a>

        <div class="method-heading">
          <a href="#M000229" class="method-signature">
          <span class="method-name">send_channel_request</span><span class="method-args">(request_name, *data, &amp;callback)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sends a <a href="Channel.html#M000207">new</a> channel request with the
given name. The extra <tt>data</tt> parameter must either be empty, or
consist of an even number of arguments. See <a
href="../Buffer.html#M000269">Net::SSH::Buffer.from</a> for a description
of their format. If a block is given, it is registered as a callback for a
pending request, and the packet will be flagged so that the server knows a
reply is required. If no block is given, the server will send no response
to this request. Responses, where required, will cause the callback to be
invoked with the channel as the first argument, and either true or false as
the second, depending on whether the request succeeded or not. The meaning
of &quot;success&quot; and &quot;failure&quot; in this context is dependent
on the specific request that was sent.
</p>
<pre>
  channel.send_channel_request &quot;shell&quot; do |ch, success|
    if success
      puts &quot;user shell started successfully&quot;
    else
      puts &quot;could not start user shell&quot;
    end
  end
</pre>
<p>
Most channel requests you&#8216;ll want to send are already wrapped in more
convenient helper methods (see <a href="Channel.html#M000210">exec</a> and
<a href="Channel.html#M000211">subsystem</a>).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000229-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000229-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 463</span>
463:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">send_channel_request</span>(<span class="ruby-identifier">request_name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">data</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">callback</span>)
464:       <span class="ruby-identifier">info</span> { <span class="ruby-node">&quot;sending channel request #{request_name.inspect}&quot;</span> }
465:       <span class="ruby-identifier">msg</span> = <span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">from</span>(<span class="ruby-identifier">:byte</span>, <span class="ruby-constant">CHANNEL_REQUEST</span>,
466:         <span class="ruby-identifier">:long</span>, <span class="ruby-identifier">remote_id</span>, <span class="ruby-identifier">:string</span>, <span class="ruby-identifier">request_name</span>,
467:         <span class="ruby-identifier">:bool</span>, <span class="ruby-operator">!</span><span class="ruby-identifier">callback</span>.<span class="ruby-identifier">nil?</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">data</span>)
468:       <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">send_message</span>(<span class="ruby-identifier">msg</span>)
469:       <span class="ruby-identifier">pending_requests</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">callback</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">callback</span>
470:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000214" class="method-detail">
        <a name="M000214"></a>

        <div class="method-heading">
          <a href="#M000214" class="method-signature">
          <span class="method-name">send_data</span><span class="method-args">(data)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sends data to the channel&#8216;s remote endpoint. This usually has the
effect of sending the given string to the remote <a
href="Channel.html#M000221">process</a>&#8217; stdin stream. Note that it
does not immediately send the data across the channel, but instead merely
appends the given data to the channel&#8216;s output buffer, preparatory to
being packaged up and sent out the next time the connection is accepting
data. (A connection might not be accepting data if, for instance, it has
filled its data window and has not yet been resized by the remote
end-point.)
</p>
<p>
This will raise an exception if the channel has previously declared that no
more data will be sent (see eof!).
</p>
<pre>
  channel.send_data(&quot;the password\n&quot;)
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000214-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000214-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 249</span>
249:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">send_data</span>(<span class="ruby-identifier">data</span>)
250:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">EOFError</span>, <span class="ruby-value str">&quot;cannot send data if channel has declared eof&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">eof?</span>
251:       <span class="ruby-identifier">output</span>.<span class="ruby-identifier">append</span>(<span class="ruby-identifier">data</span>.<span class="ruby-identifier">to_s</span>)
252:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000211" class="method-detail">
        <a name="M000211"></a>

        <div class="method-heading">
          <a href="#M000211" class="method-signature">
          <span class="method-name">subsystem</span><span class="method-args">(subsystem, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Syntactic sugar for requesting that a <a
href="Channel.html#M000211">subsystem</a> be started. Subsystems are a way
for other protocols (like SFTP) to be run, using <a
href="../../SSH.html">SSH</a> as the transport. Generally, you&#8216;ll
never need to call this directly unless you are the implementor of
something that consumes an <a href="../../SSH.html">SSH</a> <a
href="Channel.html#M000211">subsystem</a>, like SFTP.
</p>
<pre>
  channel.subsystem(&quot;sftp&quot;) do |ch, success|
    if success
      puts &quot;subsystem successfully started&quot;
    else
      puts &quot;subsystem could not be started&quot;
    end
  end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000211-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000211-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 175</span>
175:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">subsystem</span>(<span class="ruby-identifier">subsystem</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
176:       <span class="ruby-identifier">send_channel_request</span>(<span class="ruby-value str">&quot;subsystem&quot;</span>, <span class="ruby-identifier">:string</span>, <span class="ruby-identifier">subsystem</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
177:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000216" class="method-detail">
        <a name="M000216"></a>

        <div class="method-heading">
          <a href="#M000216" class="method-signature">
          <span class="method-name">wait</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Runs the <a href="../../SSH.html">SSH</a> event loop until the channel is
no longer active. This is handy for blocking while you <a
href="Channel.html#M000216">wait</a> for some channel to finish.
</p>
<pre>
  channel.exec(&quot;grep ...&quot;) { ... }
  channel.wait
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000216-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000216-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/connection/channel.rb, line 268</span>
268:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">wait</span>
269:       <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">loop</span> { <span class="ruby-identifier">active?</span> }
270:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>